export const isMarkAllowedInRange = (doc, ranges, type) => {
    for (let i = 0; i < ranges.length; i++) {
        const { $from, $to } = ranges[i];
        let can = $from.depth === 0 ? doc.type.allowsMarkType(type) : false;
        doc.nodesBetween($from.pos, $to.pos, node => {
            if (can) {
                return false;
            }
            can = node.inlineContent && node.type.allowsMarkType(type);
            return;
        });
        if (can) {
            return can;
        }
    }
    return false;
};
export const isMarkExcluded = (type, marks) => {
    if (marks) {
        return marks.some(mark => mark.type !== type && mark.type.excludes(type));
    }
    return false;
};
const not = (fn) => (arg) => !fn(arg);
const ɵ0 = not;
export const removeBlockMarks = (state, marks) => {
    const { selection, schema } = state;
    let { tr } = state;
    // Marks might not exist in Schema
    const marksToRemove = marks.filter(Boolean);
    if (marksToRemove.length === 0) {
        return undefined;
    }
    /** Saves an extra dispatch */
    let blockMarksExists = false;
    const hasMark = (mark) => marksToRemove.indexOf(mark.type) > -1;
    /**
     * When you need to toggle the selection
     * when another type which does not allow alignment is applied
     */
    state.doc.nodesBetween(selection.from, selection.to, (node, pos) => {
        if (node.type === schema.nodes.paragraph && node.marks.some(hasMark)) {
            blockMarksExists = true;
            const resolvedPos = state.doc.resolve(pos);
            const withoutBlockMarks = node.marks.filter(not(hasMark));
            tr = tr.setNodeMarkup(resolvedPos.pos, undefined, node.attrs, withoutBlockMarks);
        }
    });
    return blockMarksExists ? tr : undefined;
};
/**
 * Removes marks from nodes in the current selection that are not supported
 */
export const sanitizeSelectionMarks = (state) => {
    let tr;
    const { $from, $to } = state.tr.selection;
    state.doc.nodesBetween($from.pos, $to.pos, (node, pos) => {
        node.marks.forEach(mark => {
            if (!node.type.allowsMarkType(mark.type)) {
                const filteredMarks = node.marks.filter(m => m.type !== mark.type);
                const position = pos > 0 ? pos - 1 : 0;
                tr = (tr || state.tr).setNodeMarkup(position, undefined, node.attrs, filteredMarks);
            }
        });
    });
    return tr;
};
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFyay11dGlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9odG1sLWVkaXRvci9wcm9zZW1pcnJvci9tYXJrLXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE1BQU0sQ0FBQyxNQUFNLG9CQUFvQixHQUFHLENBQ2hDLEdBQVMsRUFDVCxNQUE2QixFQUM3QixJQUFjLEVBQ1AsRUFBRTtJQUNULEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ3BDLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pDLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1FBQ3BFLEdBQUcsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFO1lBQ3hDLElBQUksR0FBRyxFQUFFO2dCQUNMLE9BQU8sS0FBSyxDQUFDO2FBQ2hCO1lBQ0QsR0FBRyxHQUFHLElBQUksQ0FBQyxhQUFhLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0QsT0FBTztRQUNYLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxHQUFHLEVBQUU7WUFDTCxPQUFPLEdBQUcsQ0FBQztTQUNkO0tBQ0o7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDLENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsQ0FDMUIsSUFBYyxFQUNkLEtBQTBCLEVBQ25CLEVBQUU7SUFDVCxJQUFJLEtBQUssRUFBRTtRQUNQLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7S0FDN0U7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNqQixDQUFDLENBQUM7QUFFRixNQUFNLEdBQUcsR0FBRyxDQUFJLEVBQTBCLEVBQUUsRUFBRSxDQUFDLENBQUMsR0FBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQzs7QUFFcEUsTUFBTSxDQUFDLE1BQU0sZ0JBQWdCLEdBQUcsQ0FDNUIsS0FBa0IsRUFDbEIsS0FBa0MsRUFDWCxFQUFFO0lBQ3pCLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEdBQUcsS0FBSyxDQUFDO0lBQ3BDLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUM7SUFFbkIsa0NBQWtDO0lBQ2xDLE1BQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDNUMsSUFBSSxhQUFhLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtRQUM1QixPQUFPLFNBQVMsQ0FBQztLQUNwQjtJQUVELDhCQUE4QjtJQUM5QixJQUFJLGdCQUFnQixHQUFHLEtBQUssQ0FBQztJQUU3QixNQUFNLE9BQU8sR0FBRyxDQUFDLElBQVUsRUFBRSxFQUFFLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDdEU7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQy9ELElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNsRSxnQkFBZ0IsR0FBRyxJQUFJLENBQUM7WUFDeEIsTUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDM0MsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztZQUMxRCxFQUFFLEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FDakIsV0FBVyxDQUFDLEdBQUcsRUFDZixTQUFTLEVBQ1QsSUFBSSxDQUFDLEtBQUssRUFDVixpQkFBaUIsQ0FDcEIsQ0FBQztTQUNMO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUM3QyxDQUFDLENBQUM7QUFFRjs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLHNCQUFzQixHQUFHLENBQ2xDLEtBQWtCLEVBQ0ssRUFBRTtJQUN6QixJQUFJLEVBQTJCLENBQUM7SUFDaEMsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRyxLQUFLLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQztJQUMxQyxLQUFLLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUU7UUFDckQsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDdEMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDbkUsTUFBTSxRQUFRLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN2QyxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FDL0IsUUFBUSxFQUNSLFNBQVMsRUFDVCxJQUFJLENBQUMsS0FBSyxFQUNWLGFBQWEsQ0FDaEIsQ0FBQzthQUNMO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU8sRUFBRSxDQUFDO0FBQ2QsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTm9kZSwgTWFyaywgTWFya1R5cGUgfSBmcm9tIFwicHJvc2VtaXJyb3ItbW9kZWxcIjtcbmltcG9ydCB7IFNlbGVjdGlvblJhbmdlLCBFZGl0b3JTdGF0ZSwgVHJhbnNhY3Rpb24gfSBmcm9tIFwicHJvc2VtaXJyb3Itc3RhdGVcIjtcblxuZXhwb3J0IGNvbnN0IGlzTWFya0FsbG93ZWRJblJhbmdlID0gKFxuICAgIGRvYzogTm9kZSxcbiAgICByYW5nZXM6IEFycmF5PFNlbGVjdGlvblJhbmdlPixcbiAgICB0eXBlOiBNYXJrVHlwZSxcbik6IGJvb2xlYW4gPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHsgJGZyb20sICR0byB9ID0gcmFuZ2VzW2ldO1xuICAgICAgICBsZXQgY2FuID0gJGZyb20uZGVwdGggPT09IDAgPyBkb2MudHlwZS5hbGxvd3NNYXJrVHlwZSh0eXBlKSA6IGZhbHNlO1xuICAgICAgICBkb2Mubm9kZXNCZXR3ZWVuKCRmcm9tLnBvcywgJHRvLnBvcywgbm9kZSA9PiB7XG4gICAgICAgICAgICBpZiAoY2FuKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FuID0gbm9kZS5pbmxpbmVDb250ZW50ICYmIG5vZGUudHlwZS5hbGxvd3NNYXJrVHlwZSh0eXBlKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjYW4pIHtcbiAgICAgICAgICAgIHJldHVybiBjYW47XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzTWFya0V4Y2x1ZGVkID0gKFxuICAgIHR5cGU6IE1hcmtUeXBlLFxuICAgIG1hcmtzPzogQXJyYXk8TWFyaz4gfCBudWxsLFxuKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKG1hcmtzKSB7XG4gICAgICAgIHJldHVybiBtYXJrcy5zb21lKG1hcmsgPT4gbWFyay50eXBlICE9PSB0eXBlICYmIG1hcmsudHlwZS5leGNsdWRlcyh0eXBlKSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5cbmNvbnN0IG5vdCA9IDxUPihmbjogKChhcmdzOiBUKSA9PiBib29sZWFuKSkgPT4gKGFyZzogVCkgPT4gIWZuKGFyZyk7XG5cbmV4cG9ydCBjb25zdCByZW1vdmVCbG9ja01hcmtzID0gKFxuICAgIHN0YXRlOiBFZGl0b3JTdGF0ZSxcbiAgICBtYXJrczogQXJyYXk8TWFya1R5cGUgfCB1bmRlZmluZWQ+LFxuKTogVHJhbnNhY3Rpb24gfCB1bmRlZmluZWQgPT4ge1xuICAgIGNvbnN0IHsgc2VsZWN0aW9uLCBzY2hlbWEgfSA9IHN0YXRlO1xuICAgIGxldCB7IHRyIH0gPSBzdGF0ZTtcblxuICAgIC8vIE1hcmtzIG1pZ2h0IG5vdCBleGlzdCBpbiBTY2hlbWFcbiAgICBjb25zdCBtYXJrc1RvUmVtb3ZlID0gbWFya3MuZmlsdGVyKEJvb2xlYW4pO1xuICAgIGlmIChtYXJrc1RvUmVtb3ZlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKiBTYXZlcyBhbiBleHRyYSBkaXNwYXRjaCAqL1xuICAgIGxldCBibG9ja01hcmtzRXhpc3RzID0gZmFsc2U7XG5cbiAgICBjb25zdCBoYXNNYXJrID0gKG1hcms6IE1hcmspID0+IG1hcmtzVG9SZW1vdmUuaW5kZXhPZihtYXJrLnR5cGUpID4gLTE7XG4gICAgLyoqXG4gICAgICogV2hlbiB5b3UgbmVlZCB0byB0b2dnbGUgdGhlIHNlbGVjdGlvblxuICAgICAqIHdoZW4gYW5vdGhlciB0eXBlIHdoaWNoIGRvZXMgbm90IGFsbG93IGFsaWdubWVudCBpcyBhcHBsaWVkXG4gICAgICovXG4gICAgc3RhdGUuZG9jLm5vZGVzQmV0d2VlbihzZWxlY3Rpb24uZnJvbSwgc2VsZWN0aW9uLnRvLCAobm9kZSwgcG9zKSA9PiB7XG4gICAgICAgIGlmIChub2RlLnR5cGUgPT09IHNjaGVtYS5ub2Rlcy5wYXJhZ3JhcGggJiYgbm9kZS5tYXJrcy5zb21lKGhhc01hcmspKSB7XG4gICAgICAgICAgICBibG9ja01hcmtzRXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVkUG9zID0gc3RhdGUuZG9jLnJlc29sdmUocG9zKTtcbiAgICAgICAgICAgIGNvbnN0IHdpdGhvdXRCbG9ja01hcmtzID0gbm9kZS5tYXJrcy5maWx0ZXIobm90KGhhc01hcmspKTtcbiAgICAgICAgICAgIHRyID0gdHIuc2V0Tm9kZU1hcmt1cChcbiAgICAgICAgICAgICAgICByZXNvbHZlZFBvcy5wb3MsXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIG5vZGUuYXR0cnMsXG4gICAgICAgICAgICAgICAgd2l0aG91dEJsb2NrTWFya3MsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGJsb2NrTWFya3NFeGlzdHMgPyB0ciA6IHVuZGVmaW5lZDtcbn07XG5cbi8qKlxuICogUmVtb3ZlcyBtYXJrcyBmcm9tIG5vZGVzIGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB0aGF0IGFyZSBub3Qgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBjb25zdCBzYW5pdGl6ZVNlbGVjdGlvbk1hcmtzID0gKFxuICAgIHN0YXRlOiBFZGl0b3JTdGF0ZSxcbik6IFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkID0+IHtcbiAgICBsZXQgdHI6IFRyYW5zYWN0aW9uIHwgdW5kZWZpbmVkO1xuICAgIGNvbnN0IHsgJGZyb20sICR0byB9ID0gc3RhdGUudHIuc2VsZWN0aW9uO1xuICAgIHN0YXRlLmRvYy5ub2Rlc0JldHdlZW4oJGZyb20ucG9zLCAkdG8ucG9zLCAobm9kZSwgcG9zKSA9PiB7XG4gICAgICAgIG5vZGUubWFya3MuZm9yRWFjaChtYXJrID0+IHtcbiAgICAgICAgICAgIGlmICghbm9kZS50eXBlLmFsbG93c01hcmtUeXBlKG1hcmsudHlwZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZE1hcmtzID0gbm9kZS5tYXJrcy5maWx0ZXIobSA9PiBtLnR5cGUgIT09IG1hcmsudHlwZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSBwb3MgPiAwID8gcG9zIC0gMSA6IDA7XG4gICAgICAgICAgICAgICAgdHIgPSAodHIgfHwgc3RhdGUudHIpLnNldE5vZGVNYXJrdXAoXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uLFxuICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuYXR0cnMsXG4gICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkTWFya3MsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRyO1xufTtcbiJdfQ==