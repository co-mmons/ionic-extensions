{"version":3,"file":"view-observer-module.js","sources":["../../../src/view-observer/view-observer.ts","../../../src/view-observer/view-observer-module.ts"],"sourcesContent":["import {EventEmitter} from \"@angular/core\";\nimport {Platform} from \"@ionic/angular\";\nimport {Subscription} from \"rxjs\";\n\nexport class ViewObserver {\n\n    constructor(private content: HTMLIonContentElement, private readonly platform: Platform) {\n\n        this.content.parentElement.addEventListener(\"ionViewDidEnter\", this.didEnterListener = () => this.viewDidEnter());\n        this.content.parentElement.addEventListener(\"ionViewDidLeave\", this.didLeaveListener = () => this.viewDidLeave());\n\n        this.resumeSubscription = this.platform.resume.subscribe(() => this.whenResumed());\n        this.pauseSubscription = this.platform.pause.subscribe(() => this.whenPaused());\n\n        this.visible = !this.content.parentElement.classList.contains(\"ion-page-hidden\");\n    }\n\n    private visible: boolean;\n\n    private didEnterListener: (ev: Event) => void;\n\n    private didLeaveListener: (ev: Event) => void;\n\n    private paused: boolean;\n\n    private pauseSubscription: Subscription;\n\n    private resumeSubscription: Subscription;\n\n    readonly activated: EventEmitter<void> = new EventEmitter();\n\n    private async viewDidEnter() {\n        this.visible = true;\n\n        if (!this.paused) {\n            this.activated.next();\n        }\n    }\n\n    private viewDidLeave() {\n        this.visible = false;\n    }\n\n    private whenPaused() {\n        this.paused = true;\n    }\n\n    private async whenResumed() {\n        this.paused = false;\n\n        if (this.visible) {\n            this.activated.next();\n        }\n    }\n\n    isActive() {\n        return this.visible && !this.paused;\n    }\n\n    destroy() {\n        this.content.removeEventListener(\"ionViewDidEnter\" as any, this.didEnterListener);\n        this.content.removeEventListener(\"ionViewDidLeave\" as any, this.didLeaveListener);\n\n        this.resumeSubscription.unsubscribe();\n        this.pauseSubscription.unsubscribe();\n\n        this.activated.unsubscribe();\n\n        this.content = undefined;\n    }\n\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;MAIa,YAAY,CAAA;IAErB,WAAoB,CAAA,OAA8B,EAAmB,QAAkB,EAAA;QAAnE,IAAO,CAAA,OAAA,GAAP,OAAO,CAAuB;QAAmB,IAAQ,CAAA,QAAA,GAAR,QAAQ,CAAU;AAuB9E,QAAA,IAAA,CAAA,SAAS,GAAuB,IAAI,YAAY,EAAE,CAAC;QArBxD,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAC,gBAAgB,GAAG,MAAM,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;QAClH,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,IAAI,CAAC,gBAAgB,GAAG,MAAM,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;AAElH,QAAA,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC;AACnF,QAAA,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC;AAEhF,QAAA,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;KACpF;IAgBa,YAAY,GAAA;;AACtB,YAAA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AAEpB,YAAA,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;AACd,gBAAA,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;AACzB,aAAA;SACJ,CAAA,CAAA;AAAA,KAAA;IAEO,YAAY,GAAA;AAChB,QAAA,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACxB;IAEO,UAAU,GAAA;AACd,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACtB;IAEa,WAAW,GAAA;;AACrB,YAAA,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YAEpB,IAAI,IAAI,CAAC,OAAO,EAAE;AACd,gBAAA,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;AACzB,aAAA;SACJ,CAAA,CAAA;AAAA,KAAA;IAED,QAAQ,GAAA;QACJ,OAAO,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;KACvC;IAED,OAAO,GAAA;QACH,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,iBAAwB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAClF,IAAI,CAAC,OAAO,CAAC,mBAAmB,CAAC,iBAAwB,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;AAElF,QAAA,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,CAAC;AACtC,QAAA,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE,CAAC;AAErC,QAAA,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;AAE7B,QAAA,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;KAC5B;AAEJ;;ACvED;;AAEG;;;;"}